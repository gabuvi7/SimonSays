<!DOCTYPE html>
<html>

<head>
    <title>Simon Says</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <link rel="stylesheet" href="dist/styles.css">
</head>

<body>
    <div class="container-fluid d-flex " id="idBox">
        <div class="container align-self-center">
            <div class="row">
                <div class="col-6 p-0 ">
                    <button class="float-right" id="blue"></button>
                </div>
                <div class="col-6 p-0">
                    <button class="float-left" id="red"></button>
                </div>
            </div>
            <div class="row justify-content-center">
                <button id="idStartGame" onclick="startGame()">Empieza el juego!</button>
            </div>
            <div class="row">
                <div class="col-6 p-0 ">
                    <button class="float-right" id="yellow"></button>
                </div>
                <div class="col-6 p-0 float-rigth">
                    <button class="float-left" id="green"></button>
                </div>
            </div>
        </div>
    </div>

    <script>

        const blue = document.getElementById('blue');
        const red = document.getElementById('red');
        const yellow = document.getElementById('yellow');
        const green = document.getElementById('green');
        const btnStart = document.getElementById('idStartGame');

        class Game {
            constructor() {
                this.init();
                this.generateSequence();
                this.nextLevel();
            }

            init() {
                this.selectColour = this.selectColour.bind(this);
                btnStart.classList.add('hide');
                this.level = 1;
                this.colours = {
                    blue,
                    red,
                    yellow,
                    green
                }
            }

            generateSequence() {
                this.sequence = new Array(10).fill(0).map(n => Math.floor(Math.random() * 4))
            }

            nextLevel() {
                this.lightUpSequence();
                this.addClickEvents();
            }

            transformNumbersToColours(num) {
                switch (num) {
                    case 0:
                        return 'blue';
                    case 1:
                        return 'red';
                    case 2:
                        return 'yellow';
                    case 3:
                        return 'green';
                }
            }

            lightUpSequence() {
                for (let i = 0; i < this.level; i++) {
                    const colour = this.transformNumbersToColours(this.sequence[i]);
                   setTimeout( () => this.turnOnColour(colour), 1000 * i);
                }
            }

            turnOnColour(colour){
                this.colours[colour].classList.add('light');
                setTimeout( () => this.turnOffColour(colour), 350)
            }

            turnOffColour(colour){
                this.colours[colour].classList.remove('light');
            }

            addClickEvents() {
                this.colours.blue.addEventListener('click', this.selectColour)
                this.colours.red.addEventListener('click', this.selectColour)
                this.colours.yellow.addEventListener('click', this.selectColour)
                this.colours.green.addEventListener('click', this.selectColour)
            }

            selectColour(ev) {
                console.log(this);
                
                
            }

        }
        function startGame() {
            window.game = new Game();
        }
    </script>
</body>
<footer>

</footer>

</html>